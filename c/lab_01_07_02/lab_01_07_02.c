/*!
 * \file
 * \brief –ó–∞–¥–∞—á–∞ 7
 *
 * –ü—Ä–∏–Ω—è–≤ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã ùë• –∏ ùúÄ, 0 < ùúÄ ‚©Ω 1, –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é1 ùúÄ –ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ùë†(ùë•) 
 * –∏ —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ùëì (ùë•) —Ñ—É–Ω–∫—Ü–∏–∏ ùëì , –∞–±—Å–æ–ª—é—Ç–Ω—É—é ‚àÜ –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é ùõø –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏:
 * (‚àÄùë• : |ùë•| ‚©Ω 1) ùëì (ùë•) = arcsin(ùë•)
 */

#include <stdio.h>
#include <math.h>

#define MACHINE_EPS 0.00000001          // –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –¥—Ä–æ–±–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å –Ω—É–ª–µ–º

#define EXIT_CODE_INCORRECT_INPUT 1     // –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞
#define EXIT_CODE_INCORRECT_X 2         // X –ø–æ –º–æ–¥—É–ª—é –±–æ–ª—å—à–µ –µ–¥–∏–Ω–∏—Ü—ã
#define EXIT_CODE_INCORRECT_EPS 3       // eps –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª—É (0, 1]

/*!
 * \brief –°—á–∏—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —á–ª–µ–Ω —Ä—è–¥–∞
 *
 * \param term —Ç–µ–∫—É—â–∏–π —á–ª–µ–Ω —Ä—è–¥–∞ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è
 * \param n –Ω–æ–º–µ—Ä —ç—Ç–æ–≥–æ —á–ª–µ–Ω–∞ —Ä—è–¥–∞ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è
 * \param x –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏
 * \return —Å–ª–µ–¥—É—é—â–∏–π —á–ª–µ–Ω —Ä—è–¥–∞ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è
 *
 * –î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —á–ª–µ–Ω —Ä—è–¥–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º —á–∏—Å–ª–æ–º term, 
 * –Ω–æ–º–µ—Ä —á–ª–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª—ã–º —á–∏—Å–ª–æ–º n, –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º —á–∏—Å–ª–æ–º x,
 * –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —á–ª–µ–Ω —Ä—è–¥–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º —á–∏—Å–ª–æ–º.
 */
long double asin_next_term(long double term, long long n, long double x)
{
    return term * (2 * n - 1) * (2 * n - 1) / (2 * n) / (2 * n + 1) * powl(x, 2);
}

/*!
 * \brief –°—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É —Ä—è–¥–∞ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ ùëì(ùë•) = arcsin(ùë•)
 *
 * –î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º —á–∏—Å–ª–æ–º X –ø–æ –º–æ–¥—É–ª—é –º–µ–Ω—å—à–∏–º –µ–¥–∏–Ω–∏—Ü—ã,
 * –∏ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º —á–∏—Å–ª–æ–º eps –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏–∏—Ç –ø–æ–ª—É–∏–Ω—Ç–µ—Ä–≤–∞–ª—É (0, 1],
 * –∏ –≤—ã–≤–æ–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –∏ —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ s, f,
 * –∞–±—Å–æ–ª—é—Ç–Ω—É—é –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –¥—Ä–æ–±–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ abs_error, rel_error.
 */
int main(void)
{
    long double x;                       // –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
    long double eps;                     // –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –¥—Ä–æ–±–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å –Ω—É–ª–µ–º
    long double s, f;                    // –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –∏ —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
    long double abs_error, rel_error;    // –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –∏ –æ—Ç–Ω–æ–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏
    long double term;                    // —á–ª–µ–Ω —Ä—è–¥–∞
    int r;

    printf("–í–≤–µ–¥–∏—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç x –∏ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å e: ");
    r = scanf("%Lf%Lf", &x, &eps);

    if (r != 2)
        return EXIT_CODE_INCORRECT_INPUT;

    if (fabsl(x) > 1)
        return EXIT_CODE_INCORRECT_X;

    if ((eps <= 0) | (eps > 1))
        return EXIT_CODE_INCORRECT_EPS;

    // –û—Å–Ω–æ–≤–æ–Ω–æ–π –±–ª–æ–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    f = asinl(x);
    s = 0;
    term = x;
    for (long long i = 1; fabsl(term) >= eps; i++)
    {
        s += term;
        term = asin_next_term(term, i, x);
    }

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–µ–π
    abs_error = fabsl(f - s);
    if (fabsl(f) < MACHINE_EPS)
    {
        rel_error = 0;
    }
    else
    {
        rel_error = abs_error / fabsl(f);
    }

    // –ë–ª–æ–∫ –≤—ã–≤–æ–¥–∞
    printf("–ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ s: %Lf\n", s);
    printf("–¢–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ f: %Lf\n", f);
    printf("–ê–±—Å–æ–ª—é—Ç–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: %Lf\n", abs_error);
    printf("–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: %Lf\n", rel_error);

    return 0;
}